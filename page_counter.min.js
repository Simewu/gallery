let pageName,siteData={};async function fetchCounterStats(e){try{const t="https://simewu-simple-",a="count.simewu.repl.co/",o=await fetch(`${t}${a}${e}.json`);siteData=await o.json()}catch(e){console.error("Error fetching counter:",e),document.getElementById("counter").style.display="none"}}function setupModalListener(e){var t=document.getElementById("visitorModal");t&&t.addEventListener("show.bs.modal",(function(){google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback((()=>drawChart(e.total,e.daily,document.getElementById("modalPageName").textContent)))}))}function drawChart(e,t,a){var o=new google.visualization.DataTable;o.addColumn("string","Day"),o.addColumn("number","Visitors");let n=new Array(12).fill(0).map((()=>[])),l=!1;t.forEach(((e,a)=>{let o=new Date;o.setDate(o.getDate()-(t.length-1-a));let r=o.getMonth();n[r].push({date:o,count:e}),r===(new Date).getMonth()&&e>0&&(l=!0)}));let r=[];n.forEach(((e,t)=>{(e.some((e=>e.count>0))||!l&&t===(new Date).getMonth())&&(e.forEach((e=>{let t=e.date.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});r.push([t,e.count])})),l=!0)})),o.addRows(r);var d={width:800,height:400,lineWidth:5,colors:[textColorDim],hAxis:{titleTextStyle:{color:textColor},textStyle:{color:textColorDim},slantedText:!0,slantedTextAngle:45},vAxis:{title:"Number of Visitors",titleTextStyle:{color:textColor},textStyle:{color:textColorDim}},backgroundColor:bgColor,legend:"none"};new google.visualization.LineChart(document.getElementById("visitorGraphModal")).draw(o,d),document.getElementById("totalCount").innerHTML=`Total number of visitors for ${a}: <span class='text-color'>${e}</span>`;let i=t.reduce(((e,t)=>e+t),0);i==e?document.getElementById("yearlyCount").display="none":document.getElementById("yearlyCount").innerHTML=`Number of visitors in the past 365 Days: <span class='text-color'>${i}</span>`}function stats(){if(void 0===siteData.total)return!1;let e=document.querySelector('script[src="script.min.js"]'),t=document.createElement("script");t.type="text/javascript",t.src="https://www.gstatic.com/charts/loader.js",e.insertAdjacentElement("afterend",t);var a=document.createElement("div");a.className="col-auto";var o=document.createElement("span");o.id="counter",o.className="badge badge-pill float-right text-color-dim",o.setAttribute("data-bs-toggle","modal"),o.setAttribute("data-bs-target","#visitorModal"),a.appendChild(o);var n=document.querySelector("footer");if(null===n)return document.getElementById("counter").display="none",!1;var l=n.querySelector(".row");l&&l.appendChild(a);var r=document.createElement("div");r.className="modal fade",r.id="visitorModal",r.setAttribute("aria-labelledby","visitorModalLabel"),r.setAttribute("aria-hidden","true");var d=document.createElement("div");d.className="modal-dialog modal-lg",r.appendChild(d);var i=document.createElement("div");i.className="modal-content bg-color-dimmer modal-lg",d.appendChild(i);var s=document.createElement("div");s.className="modal-header",i.appendChild(s);var c=document.createElement("h5");c.className="modal-title",c.id="visitorModalLabel",c.innerHTML='Counter for <b><span id="modalPageName" class="text-color"></span></b>',s.appendChild(c);var m=document.createElement("button");m.type="button",m.className="btn-close bg-color-inv",m.setAttribute("data-bs-dismiss","modal"),m.setAttribute("aria-label","Close"),s.appendChild(m);var u=document.createElement("div");u.className="modal-body p-2",i.appendChild(u);var p=document.createElement("div");p.id="totalCount",u.appendChild(p);var g=document.createElement("div");g.id="visitorGraphModal",u.appendChild(g);var h=document.createElement("div");return h.id="yearlyCount",u.appendChild(h),n.appendChild(r),document.getElementById("counter").textContent=siteData.total,document.getElementById("modalPageName").textContent=pageName.charAt(0).toUpperCase()+pageName.slice(1),setupModalListener(siteData),!0}function counterInit(){let e=document.querySelector('script[src="script.min.js"]'),t=document.createElement("script");function a(){dataLayer.push(arguments)}t.type="text/javascript",t.src="https://www.googletagmanager.com/gtag/js?id=G-LGHB6S47PK",e.insertAdjacentElement("afterend",t),window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","G-LGHB6S47PK"),pageName=location.href.split("/")[location.href.split("/").length-1].toLowerCase(),""===pageName&&(pageName="index");["index","projects","publications","gallery","resume","contact","submitted"].includes(pageName)&&fetchCounterStats(pageName)}setTimeout(counterInit,10);